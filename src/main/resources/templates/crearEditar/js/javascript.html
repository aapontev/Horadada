<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
	<script type="text/javascript" th:fragment="mapa">
	 
	var marker;          //variable del marcador
	var coords = {};    //coordenadas obtenidas con la geolocalizaci√≥n
	 
	initMap = function () 
	{	 
	        navigator.geolocation.getCurrentPosition(
	          function (position){
	            coords =  {
	              lng: position.coords.longitude,
	              lat: position.coords.latitude
	            };
	            setMapa(coords);  //pasamos las coordenadas al metodo para crear el mapa            
	           
	          },function(error){console.log(error);});    
	}
	function setMapa (coords)
	{   
	      var map = new google.maps.Map(document.getElementById('mapa'),
	      {
	        zoom: 13,
	        center:new google.maps.LatLng(coords.lat,coords.lng),	 
	      });
	 
	      marker = new google.maps.Marker({
	        map: map,
	        draggable: true,
	        animation: google.maps.Animation.DROP,
	        position: new google.maps.LatLng(coords.lat,coords.lng),	 
	      });
	      
	      marker.addListener( 'dragend', function (event)
	      {
	        $("#lati").val(this.getPosition().lat());
	        $("#longi").val(this.getPosition().lng());
	      });
	}	 
	</script>
	<script type="text/javascript" th:fragment="servicio">

	$(document).ready(function() {

		$("#buscar_servicio").autocomplete({

			source : function(request, response) {
				$.ajax({
					url : "/factura/cargar-productos/" + request.term,
					dataType : "json",
					data : {
						term : request.term
					},
					success : function(data) {
						response($.map(data, function(item) {
							return {
								value : item.id,
								label : item.nombre,
								precio : item.precio,
							};
						}));
					},
				});
			}})}
	</script>

</body>
</html>